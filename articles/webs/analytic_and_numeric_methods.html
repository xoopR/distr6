<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Decorators, Analytical and Numerical Methods • distr6</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><!-- docsearch --><script src="../../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Decorators, Analytical and Numerical Methods">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">distr6</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.8.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Basic

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/webs/intro_to_r6.html">Introduction to R6</a>
    </li>
    <li>
      <a href="../../articles/webs/constructing_a_distribution.html">Constructing a Distribution</a>
    </li>
    <li>
      <a href="../../articles/webs/parameters.html">Getting and Setting Parameters</a>
    </li>
    <li>
      <a href="../../articles/webs/statistical_methods.html">Statistical Methods</a>
    </li>
    <li>
      <a href="../../articles/webs/properties_traits.html">Properties and Traits</a>
    </li>
    <li>
      <a href="../../articles/webs/multivariates.html">Multivariate Distributions</a>
    </li>
    <li>
      <a href="../../articles/webs/listing.html">Listing</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Advanced

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/webs/decorators.html">Decorators</a>
    </li>
    <li>
      <a href="../../articles/webs/wrappers.html">Wrappers</a>
    </li>
    <li>
      <a href="../../articles/webs/custom_distributions.html">Custom Distributions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Appendices

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://raphaels1.github.io/pdfs/distr6Cheatsheet.pdf" class="external-link">Cheatsheet</a>
    </li>
    <li>
      <a href="../../articles/webs/r6_and_design_patterns.html">R6 and Design Patterns</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../../reference/">Reference</a>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/RaphaelS1/distr6" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>

    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Decorators, Analytical and Numerical
Methods</h1>
            
            <h4 data-toc-skip class="date">2024-07-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/xoopr/distr6/blob/main/vignettes/webs/analytic_and_numeric_methods.rmd" class="external-link"><code>vignettes/webs/analytic_and_numeric_methods.rmd</code></a></small>
      <div class="hidden name"><code>analytic_and_numeric_methods.rmd</code></div>

    </div>

    
    
<p>This document is for understanding how and when distr6 uses
analytical or numerical results. For a tutorial on how to use
decorators, <a href="https://xoopr.github.io/distr6/articles/webs/decorators.html">see
here</a>.</p>
<p>distr6 operates under a strict rule that implemented distributions,
of class <code>SDistribution</code>, and similarly implemented kernels,
of class <code>Kernel</code>, should only contain analytical methods.
This ensures that all results are as precise as possible and ensure
optimal efficiency.</p>
<!-- The figure below gives a visual representation of how this looks.  -->
<p>It was not a straightforward decision deciding which methods should
be included in the core distribution interfaces. We made the decision
that methods involving infinite sums should not be included as any
approximation via numerical integration would not be sufficiently
accurate. However we allowed the use of the <code>beta</code>,
<code>gamma</code>, and <code>digamma</code> functions from base R
packages, as these are widely used in the community, have good
documentation and have been widely tested. We additionally chose to
include the <code>gammaz</code> and <code>gammainc</code> methods from
<code>pracma</code> and <code>expint</code>, both packages use C
implementations and appear to be in wide usage although we encourage the
user to examine these further if interested.</p>
<p>For distributions where no closed form analytical expression can be
found, details of this are found in the ‘Details’ section of the
distribution’s help page, and attempting to run the function will throw
an error. To impute numerical results, decorators are used.</p>
<!-- ![](img/decorators.png) -->
<p>Currently distr6 has three decorators:</p>
<ol style="list-style-type: decimal">
<li><code>CoreStatistics</code></li>
<li><code>ExoticStatistics</code></li>
<li><code>FunctionImputation</code></li>
</ol>
<p><code>CoreStatistics</code> contains all commonly used mathematical
and statistical functions used to describe a probability distribution,
for example: expectation, variance, kurtosis and skewness. In addition
there is a generalised expectation function <code>genExp</code> that can
be used to find any generic expectation of the distribution of the form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[f(X)]</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(X)</annotation></semantics></math>
can be any function acting on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>.
This is particularly useful for more complex functions such as
<code>kthmoment</code>.</p>
<p><code>ExoticStatistics</code> contains less commonly used functions
for the general user but useful functions for modelling and survival
analysis. These include survival, hazard and any p-norm of pdf.</p>
<p><code>FunctionImputation</code> imputes the pdf/cdf/quantile/random
using numerical methods, depending which are provided. These follow a
strict hierarchy to maximise efficiency and minimise error from
numerical approximations. The hierarchy is as follows:</p>
<ul>
<li>To impute the pdf: <code>cdf2pdf</code>; <code>rand2pdf</code>;
<code>quantile2pdf</code>
</li>
<li>To impute the cdf: <code>quantile2cdf</code>; <code>pdf2cdf</code>;
<code>rand2cdf</code>
</li>
<li>To impute the quantile: <code>cdf2quantile</code>;
<code>pdf2quantile</code>; <code>rand2quantile</code>
</li>
<li>To impute the rand: <code>quantile2rand</code>;
<code>cdf2rand</code>; <code>pdf2rand</code>
</li>
</ul>
<p>When a decorator is constructed, only the functions that do not exist
analytically are added. For example, if a distribution has an analytical
<code>variance</code> function as part of its core interface, then this
will not be overloaded by the <code>CoreStatistics</code> decorator.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="va"><a href="../../reference/Normal.html">Normal</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>decorators <span class="op">=</span> <span class="st">"CoreStatistics"</span><span class="op">)</span></span>
<span><span class="va">n</span><span class="op">$</span><span class="va">mean</span> <span class="co"># The analytical method</span></span>
<span><span class="co">#&gt; function (...) </span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     unlist(self$getParameterValue("mean"))</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; &lt;environment: 0x1209e2ea8&gt;</span></span></code></pre></div>
<p>Similarly where possible an analytical method is always preferred.
For example, if an analytical <code>cdf</code> expression is available,
then the <code>survival</code> function in <code>ExoticStatistics</code>
is defined as <code>1 - cdf</code> otherwise a numerical integration is
calculated.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="va"><a href="../../reference/Normal.html">Normal</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>decorators <span class="op">=</span> <span class="st">"ExoticStatistics"</span><span class="op">)</span></span>
<span><span class="va">n</span><span class="op">$</span><span class="fu">survival</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">==</span> <span class="va">n</span><span class="op">$</span><span class="fu">cdf</span><span class="op">(</span><span class="fl">2</span>, lower.tail <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="co"># The analytical method</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Finally, even if an analytical expression for
<code>expectation</code> exists, the <code>CoreStatistics</code>
decorator always adds a <code>genExp</code> method for a generalised
numerical expectation formula, this is required for numerical results
for variance, moments, etc.</p>
<p>See the <a href="https://xoopr.github.io/distr6/articles/webs/decorators.html">decorators
tutorial</a> for details on how to decorate a Distribution.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Raphael Sonabend, Franz Kiraly.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({


    apiKey: 'c08037a20302b0f7fe5a1b7060957f04',
    indexName: 'distr6',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
